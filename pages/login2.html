<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MY APP</title>
</head>
<body>
  May Node and Express be with you.
</body>
</html> -->

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>URL Shortener</title>
  <link href='https://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link href="pages/css/styles.css" rel="stylesheet">
</head>
<body>
  My Login Page!!!!!

  <form action="/login" method="POST">
    <input id="username" type="text" name="username" placeholder="username">
    <input id="password" type="password" name="password" placeholder="password">
   <button type="submit" value="Login" onclick="validate()">Submit</button>
 </form>

 <form action="/register" method="POST">
   <input id="username" type="text" name="username" placeholder="username">
   <input id="password" type="password" name="password" placeholder="password">
  <button type="submit">Register</button>
 </form>

 <!-- <input id="username" type="text" name="username" placeholder="username">
 <input id="password" type="password" name="password" placeholder="password">
	<button id="send" onclick="myFunction()">Login</button> -->

	<!-- <h2 id="result"></h2> -->




	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

	<script>
		$('#send').click(()=>{
			$(function(){
				var data = {longUrl: $('#longUrl').val(),
			                userID: $('#userID').val()};

				console.log("Sending: "+data.longUrl+":"+data.userID);
				$.ajax({
					type: "POST",
					url: "http://localhost:30000/urlCaller",
					data: data,
					success:  ( res )=> {
					//$( "#result" ).text( JSON.stringify(res) )
					//console.log(res);
					var jsonObj = JSON.parse(res);
					console.log("Printing Data::"+jsonObj[0].mainUrl+" :"+jsonObj[0].shortUrl+" :");//+" :"+thumbnail+" :"+title);

					var tData="<tr><td><b>Main Url</b></td><td><a href=\""+jsonObj[0].mainUrl+"\" target=\"_blank\">"+jsonObj[0].mainUrl+"</a></td></tr>";
					tData+="<tr><td><b>Short Url</b></td><td><a href=\""+jsonObj[0].shortUrl+"\" target=\"_blank\">"+jsonObj[0].shortUrl+"</a></td></tr>";
					$("#t1 tr").remove();
                    $("#t1").append(tData);


                    $("#t2 tr").remove();
                    $("#t2").append("<thead><td>Main Url</td><td>Short Url</td><td>Count</td><td></td></thead>");
                    for(var i = 1; i < jsonObj.length; i++)
					{
					    var tData="<tr><td><a href=\""+jsonObj[i].mainUrl+"\" target=\"_blank\">"+jsonObj[i].mainUrl+"</a></td>";
						tData+="<td><a href=\""+jsonObj[i].shortUrl+"\" target=\"_blank\">"+jsonObj[i].shortUrl+"</a></td>";
						tData+="<td>"+jsonObj[i].count+"</td>";
						//******************Deletion Requiring Multiple Check Boxes********************************
						//tData+="<td><input type=\"checkbox\" name=\"chk_group\" value=\""+jsonObj[i]._id+"\"/></td></tr>";
						tData+="<td><button id=\"invalidate\" name=\"invalidate\" value=\""+jsonObj[i]._id+"\"onclick=\"myFunction()\">Invalidate</button></td></tr>";
						$("#t2").append(tData);
					}
					//******************Deletion Requiring Multiple Check Boxes********************************
					//var lastLine="<tr><td></td><td></td><td></td><td><button id=\"invalidate\" onclick=\"myFunction()\">Invalidate</button></td></tr>"
                    //$("#t2").append(lastLine)
                  }

				});
			});
		});

        function myFunction() {
        	console.log($('#invalidate').val());
        	var data = {id: $('#invalidate').val()};
        			$.ajax({
            			type: "POST",
						url: "http://localhost:30000/deletion",
						data: data,
						success:  ( res )=> {
						}
            		});
        }

        function validate() {
              var text1 = document.getElementById("username");
              var text2 = document.getElementById("password");
              if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(text1.value))
              {
                alert("Email verified")
              }
                else {
                alert("You have entered an invalid email address!")
                }
              if (text1.value == "abcd" && text2.value == "abcd") {
                load("login1.html");
              } else {
                load("https://stackoverflow.com/questions/43182358/express-login-with-redirect-using-node-js");
              }
            }
            url = 'https://stackoverflow.com/questions/43182358/express-login-with-redirect-using-node-js';
            function load(url) {
              location.href = url;
            }
	</script>


</body>
</html>
